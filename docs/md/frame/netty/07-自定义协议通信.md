#### 1. 网络协议基本要素

```
+---------------------------------------------------------------+ 
| 魔数 2byte | 协议版本号 1byte | 序列化算法 1byte | 报文类型 1byte  | 
+---------------------------------------------------------------+ 
| 状态 1byte |        保留字段 4byte    |      数据长度 4byte      | 
+---------------------------------------------------------------+
|                   数据内容 （长度不定）                          | 
+---------------------------------------------------------------+ 
```

**Netty 常用编码器类型：**

- MessageToByteEncoder 对象编码成字节流；
- MessageToMessageEncoder 一种消息类型编码成另外一种消息类型。

**Netty 常用解码器类型：**

- ByteToMessageDecoder/ReplayingDecoder 将字节流解码为消息对象；
- MessageToMessageDecoder 将一种消息类型解码为另外一种消息类型。

判断 ByteBuf 是否存在完整的报文，最常用的做法就是通过读取消息长度 dataLength 进行判断。如果 ByteBuf 的可读数据长度小于 dataLength，说明 ByteBuf 还不够获取一个完整的报文。在该协议前面的消息头部分包含了魔数、协议版本号、数据长度等固定字段，共 14 个字节。固定字段长度和数据长度可以作为我们判断消息完整性的依据。
